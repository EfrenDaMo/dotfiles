(defpoll get_layout 
  :interval "1s" 
  "hyprctl devices -j | jq -r '.keyboards | map (select(.name == \"kanata\"))[0].active_keymap' | cut -c1-2"
)

(defwidget language []
  (box
    :class "language"
    :orientation "h"
    :space-evenly false
    (eventbox 
      :cursor "pointer" 
      :onclick "hyprctl switchxkblayout kanata next"
      (label 
        :text {get_layout}
        :class "language-text" 
      )
    )
  )
)
